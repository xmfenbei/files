# 计算两点经纬度之间距离

## 方法一：前端自行计算
```
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>经纬度距离计算</title>
    <script language="JavaScript">
        function rad(d){
            return d * Math.PI / 180.0;
        }
        function distance( lat1,  lng1,  lat2,  lng2){
            var radLat1 = rad(lat1);
            var radLat2 = rad(lat2);
            var a = radLat1 - radLat2;
            var b = rad(lng1) - rad(lng2);
            var s = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(a/2), 2) +
                Math.cos(radLat1) * Math.cos(radLat2) * Math.pow(Math.sin(b/2), 2)));
            s = s * 6378.137 ;
            s = Math.round(s * 10000) / 10000;
            return s;
        }
        function calDis(){
            var lat1 = document.getElementById( "lat1").value * 1;
            var lat2 = document.getElementById( "lat2").value * 1;
            var lng1 = document.getElementById( "lng1").value * 1;
            var lng2 = document.getElementById( "lng2").value * 1;
            var dis =  distance(lat1, lng1, lat2, lng2);
            document.getElementById( "distance").value = dis;
        }
    </script>
</head>
<body>
<h2>经纬度距离计算</h2>
<div>
    A：纬度<input value="40.056890127931279" name="lat1" id="lat1" onkeyup="calDis()" type="text">
    经度<input value="116.30815063007148" name="lng1" id="lng1" onkeyup="calDis()" type="text">
    B：纬度<input value="35.48871262220911" name="lat2" id="lat2" onkeyup="calDis()" type="text">
    经度<input value="116.30815063007148" name="lng2" id="lng2" onkeyup="calDis()" type="text">
    A-B：距离=<input value="508.5272" name="distance" id="distance" type="text"> Km
</div>
</body>
</html>
```

## 方法二：sql语句
```
select * from 
     (select s.longitude,s.latitude,
     ROUND(6378.138*2*ASIN(SQRT(POW(SIN((".$lat."*PI()/180-s.latitude*PI()/180)/2),2)+
         COS(".$lat."*PI()/180)*COS(s.latitude*PI()/180)*POW(SIN((".$lng."*PI()/180-s.longitude*PI()/180)/2)
         ,2)))*1000) AS distance 
     from".tablename('ly_jhb_shops')." s left join ".tablename('ly_jhb_advs')." a ON 
     s.uniacid=:uniacid and a.shopid=s.id and a.type=5 order by distance
     )as d 
where d.distance<=3000
```

#### 参考资料：
[mysql中计算两点经纬度之间距离](https://baagee.vip/index/article/id/52.html)
